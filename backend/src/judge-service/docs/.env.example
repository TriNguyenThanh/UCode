# =============================================================================
# RABBITMQ CONFIGURATION
# =============================================================================
RABBITMQ_HOST=localhost

# =============================================================================
# EXECUTION SERVICE CONFIGURATION
# =============================================================================

# Số lượng submissions xử lý đồng thời
# Điều chỉnh dựa trên RAM available:
# - 4GB RAM:  MAX_CONCURRENT_SUBMISSIONS=1 (an toàn)
# - 8GB RAM:  MAX_CONCURRENT_SUBMISSIONS=2 (cân bằng)
# - 16GB RAM: MAX_CONCURRENT_SUBMISSIONS=4 (thoải mái)
MAX_CONCURRENT_SUBMISSIONS=1

# Số lượng testcases chạy song song trong 1 submission
# Điều chỉnh dựa trên CPU cores:
# - 2 cores:  MAX_WORKERS_PER_SUBMISSION=4 (với hyperthreading)
# - 4 cores:  MAX_WORKERS_PER_SUBMISSION=6
# - 8 cores:  MAX_WORKERS_PER_SUBMISSION=10
# - 16 cores: MAX_WORKERS_PER_SUBMISSION=16
MAX_WORKERS_PER_SUBMISSION=4

# =============================================================================
# DOCKER CONTAINER LIMITS (per testcase)
# =============================================================================

# Memory limit cho mỗi container (MB)
# Giảm xuống nếu server RAM thấp:
# - 4GB RAM:  128-192 MB
# - 8GB RAM:  256 MB (recommended)
# - 16GB RAM: 512 MB
DEFAULT_MEMORY_LIMIT=256

# Time limit cho mỗi testcase (seconds)
DEFAULT_TIME_LIMIT=3

# =============================================================================
# HEALTH CHECK & PROTECTION
# =============================================================================

# Ngưỡng RAM an toàn (%) - Từ chối submissions khi RAM > ngưỡng này
# Khuyến nghị: 85% cho server production
MEMORY_THRESHOLD=85

# Ngưỡng CPU an toàn (%) - Cảnh báo khi CPU > ngưỡng này  
CPU_THRESHOLD=90

# =============================================================================
# TÍNH TOÁN TÀI NGUYÊN
# =============================================================================
# Total concurrent containers = MAX_CONCURRENT_SUBMISSIONS × MAX_WORKERS_PER_SUBMISSION
# Total RAM usage = Total containers × DEFAULT_MEMORY_LIMIT
# 
# Ví dụ cấu hình AN TOÀN cho server 2 cores, 4GB RAM:
# - MAX_CONCURRENT_SUBMISSIONS=1
# - MAX_WORKERS_PER_SUBMISSION=4
# - DEFAULT_MEMORY_LIMIT=192
# - Total containers: 1 × 4 = 4
# - Total RAM: 4 × 192MB = 768MB (safe, còn 3GB cho OS + buffer)
# 
# Ví dụ cấu hình CÂN BẰNG cho server 2 cores, 8GB RAM:
# - MAX_CONCURRENT_SUBMISSIONS=2
# - MAX_WORKERS_PER_SUBMISSION=4
# - DEFAULT_MEMORY_LIMIT=256
# - Total containers: 2 × 4 = 8
# - Total RAM: 8 × 256MB = 2GB (reasonable, còn 6GB)
# =============================================================================
