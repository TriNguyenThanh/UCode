graph LR
    %% === Định nghĩa Style ===
    classDef lecturer fill:#F9E79F,stroke:#333,stroke-width:2px;
    classDef student fill:#A3E4D7,stroke:#333,stroke-width:2px;
    classDef process fill:#FFF,stroke:#333,stroke-width:2px; %% Màu fill trắng
    classDef datastore fill:#FFF,stroke:#333,stroke-width:2px; %% Màu fill trắng

    %% === Thực thể bên ngoài ===
    GV["Giảng viên"]
    SV["Sinh viên"]

    %% === Sub-processes ===
    P71("7.1Tạo buổi điểm danh<br>(QR, URL, IP)")
    P72("7.2Xác nhận điểm danh<br>của sinh viên")
    P73("7.3Lưu lịch sử điểm danh<br>(SV, IP, thời gian)")

    %% === Kho dữ liệu ===
    D_Attendance[("Thông tin điểm danh")]
    D_Class[("Thông tin lớp học")]

    %% === Gán Style ===
    class GV lecturer;
    class SV student;
    class P71,P72,P73 process;
    class D_Attendance,D_Class datastore;

    %% === Luồng dữ liệu ===
    GV -- "Tạo buổi điểm danh" --> P71
    P71 -- "Lưu buổi điểm danh" --> D_Attendance
    D_Attendance -- "Mã buổi" --> P71
    P71 -- "Xác nhận tạo" --> GV
    P71 -- "QR/URL cho SV" --> SV
    
    SV -- "Xác nhận điểm danh" --> P72
    P72 -- "Truy vấn buổi" --> D_Attendance
    D_Attendance -- "Thông tin buổi" --> P72
    P72 -- "Truy vấn lớp/SV" --> D_Class
    D_Class -- "Dữ liệu SV" --> P72
    
    P72 -- "Chuyển lưu lịch sử" --> P73
    P72 -- "Xác nhận" --> SV
    
    P73 -- "Lưu lịch sử" --> D_Attendance
    D_Attendance -- "Dữ liệu lưu" --> P73
    P73 -- "Kết quả điểm danh" --> GV